# Excel批量导入模板说明

## 模板格式

Excel文件应包含以下列（第一行为标题行）：

| 年级 | 班级 | 姓名 | 性别 | 报名项目 |
|------|------|------|------|----------|
| 一年级 | 1班 | 张三 | 男 | 男子100米,男子跳远 |
| 一年级 | 1班 | 李四 | 女 | 女子100米 |
| 二年级 | 2班 | 王五 | 男 | 男子200米,男子跳高 |

**注意**：编号不需要在Excel中填写，系统会在所有运动员导入完成后统一生成。

## 字段说明

### 年级（必填）
- 必须与系统中已存在的年级名称完全匹配
- 例如："一年级"、"二年级"、"三年级"等

### 班级（必填）
- 输入班级名称，如"1班"、"2班"
- 如果班级不存在，系统会自动创建
- 系统会从名称中提取数字作为排序依据

### 姓名（必填）
- 运动员姓名
- 不能为空

### 性别（必填）
- 只能填写："男" 或 "女"
- 必须严格匹配这两个值之一

### 报名项目（可选）
- 可以填写多个项目，用逗号、顿号或中文逗号分隔
- 例如："男子100米,男子跳远" 或 "女子100米、女子跳高"
- 项目名称必须与系统中的项目名称完全匹配
- 如果项目不存在，该项目会被跳过（不会报错）
- 可以留空，表示暂不报名项目

## 导入示例

### 示例1：完整信息
```
年级: 一年级
班级: 1班
姓名: 张三
性别: 男
报名项目: 男子100米,男子跳远
```

### 示例2：不报名项目
```
年级: 二年级
班级: 3班
姓名: 李四
性别: 女
报名项目: (留空)
```

### 示例3：新班级
```
年级: 三年级
班级: 5班  <- 如果5班不存在，会自动创建
姓名: 王五
性别: 男
报名项目: 男子200米
```

## 注意事项

1. **年级必须预先存在**
   - 导入前请确保已在系统中创建了对应的年级
   - 如果年级不存在，该行数据会被跳过，并在导入结果中显示错误信息

2. **班级会自动创建**
   - 无需提前创建班级
   - 系统会根据班级名称自动分配排序号

3. **运动员编号稍后生成**
   - 导入时不需要填写编号
   - 所有运动员导入完成后，使用"生成编号"功能统一分配编号

4. **项目名称要准确**
   - 项目名称必须与系统中的完全一致
   - 建议先在系统中查看可用项目列表
   - 常见项目：
     - 男子100米、男子200米、男子400米
     - 男子跳远、男子跳高、男子铅球
     - 女子100米、女子200米、女子400米
     - 女子跳远、女子跳高、女子铅球
     - 4x100米接力

5. **文件格式支持**
   - 支持 .xls（Excel 2003及以前）
   - 支持 .xlsx（Excel 2007及以后）

## 导入流程

1. **准备Excel文件**
   - 按照模板格式填写数据
   - 确保第一行是标题行

2. **导入数据**
   - 进入"运动员列表"页面
   - 点击"批量导入"按钮
   - 选择准备好的Excel文件
   - 点击"开始导入"

3. **检查结果**
   - 系统会显示导入成功的数量
   - 如果有错误，会显示具体的错误信息
   - 检查导入的数据是否正确

4. **生成编号**
   - 所有运动员导入完成后
   - 点击"生成编号"按钮
   - 系统会按年级→班级→性别顺序自动分配编号

## 常见错误及解决方法

### 错误：找不到年级 'XXX'
**原因**：系统中不存在该年级
**解决**：先在"年级管理"中创建对应的年级

### 错误：性别无效
**原因**：性别列的值不是"男"或"女"
**解决**：检查Excel文件，确保性别列只包含"男"或"女"

### 错误：姓名不能为空
**原因**：姓名列为空
**解决**：补充姓名信息

### 提示：项目'XXX'不存在，已跳过
**说明**：该项目在系统中不存在，该运动员会被创建但不会报名此项目
**解决**：检查项目名称是否正确，或在系统中创建该项目

## 下载模板

可以创建一个包含以下内容的Excel文件作为模板：

| 年级 | 班级 | 姓名 | 性别 | 报名项目 |
|------|------|------|------|----------|
| 一年级 | 1班 | 示例姓名 | 男 | 男子100米 |

然后删除示例数据行，填入实际数据即可。
